<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>rust for rubyists - tdc</title>

    <meta name="description" content="a talk, about rust.">
    <meta name="author" content="cristian oliveira">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/night.css" id="theme">

    <!-- for syntax highlighting -->
    <link rel="stylesheet" href="lib/css/solarized-dark.css">

    <link rel="stylesheet" href="css/presentation.css">
    <!--[if lt ie 9]>
      <script src="lib/js/html5shiv.js"></script>
      <![endif]-->
  </head>

  <body>

    <div class="reveal">

      <!-- any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <section>
          <h1>Rust from Ruby</h1> <h2>TDC - POA</h1>
          <p>
          by <a href="http://cristianoliveira.net">Cristian Oliveira</a>
          </p>
          <p>
          slides: <a href="https://github.com/cristianoliveira/rust-from-ruby">github.com/cristianoliveira/rust-from-ruby</a>
          </p>
        </section>

        <section>
        <!-- MotivationPart -->
          <section>
            <h2>Falar de Rust em uma trilha de Ruby?</h2>
          </section>

          <section>
            <h3>Legal mas:</h3>
            <ul>
              <li>Eu já programo em ruby</li>
              <li>Ruby paga as minhas contas</li>
              <li>Eu gosto de ruby</li>
            </ul>
          </section>

          <section>
            <h2>E mesmo assim devo aprender Rust?</h2>
          </section>

          <section>
            <img src="img/but-why.gif"></img>
          </section>

          <section>
            <h2>Motivo 1</h2>
            <p>"A language that doesn’t affect the way you think about programming is not worth knowing."</p>
            <p>- Alan Perlis</p>
          </section>

          <section>
            <h2>Motivo 2</h2>
            <h3>Rust é extremamente rápido.</h3>
            <pre><code class="lang-bash">
~$ time ./helloworld                                                                                 [ruby-2.2.1]
Hello, world
./helloworld  0.00s user 0.00s system 66% cpu 0.003 total
            </code></pre>
          </section>

          <section>
            <h3>Mesmo código em Ruby</h3>
            <pre><code class="lang-bash">
~$ time ruby examples/ruby/helloworld.rb
Hello, world
ruby examples/ruby/helloworld.rb  0.04s user 0.01s system 94% cpu 0.045 total
            </code></pre>
          </section>

          <section>
            <img src="img/whocares.jpg"></img>
            <p>"Não uso Ruby por ser rápido e se precisar de performance posso descer para C"</p>
          </section>

          <section>
            <img src="img/heywhat.gif"></img>
            <h2>Então qual é o ponto?</h2>
          </section>

          <section>
            <h3>Rails App</h3>
            <p>"Gostamos do Rails pois ele facilita nossa vida! Mas como lidar com uma aplicação monolitica?"</p>
          </section>

          <section>
            <h2>Rust as a service :P</h2>
          </section>

          <section>
            <h2>Motivo 2</h2>
            <p>Muita gente massa do Ruby esta participando do Rust</p>
          </section>

          <section>
            <h2>Motivo 3</h2>
            <p>Toda a segurança e conveniência do Ruby em código nativo - wycat</p>
            <img src="img/rustconf.jpg" height="500"></img>
          </section>

          <section>
            <h2>Motivo 4</h2>
            <p>Você pode aprender muito como Ruby funciona através do Rust</p>
            <h5>Tentarei ensinar algo novo hoje! :)</h5>
          </section>
        <!-- MotivationPartEnd -->
        </section>

      <section>
        <!-- ExplanationPart -->
        <section>
          <img class="ruby-logo" src="img/ruby.png"></img>
          <img class="rust-logo" src="img/rust.png"></img>
          <h1>Ruby to Rust</h1>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h3>Semelhanças</h3>
          <pre><code class="lang-ruby">
words = ["Hello", "world", "from", "Ruby"]
words.each { |w| puts w }
          </code></pre>
          <pre><code class="lang-rust">
fn main() {
    let words = vec!["hello","word", "from", "Rust"];
    for w in words {
        println!("{} ", w)
    }
}
          </code></pre>
        </section>

        <section>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <div>
            <h3>O que é?</h3>
            <p>Rust é uma linguagem compilada, extremamente rápida, de tipagem estática e que 
              foi projetada para garantir segurança, concorrência de forma prática</p>
          </div>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <div>
            <h4>Ruby é lento, mas a gente ama ele mesmo assim.</h4>
            <h1> <3 </h1>
          </div>
        </section>

        <section>
          <h2>Porque a diferença?</h2>
          <h4>Podemos aprender muito analisando Ruby e Rust</h4>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h3>Como eles executam isso?</h3>
              <pre><code class="lang-ruby">
# code.rb
2 * 7 + 3
              </code></pre>
              <pre><code class="lang-rust">
fn main() {
  2 * 7 + 3;
}
              </code></pre>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <h3>Ruby</h3>
          <img src="img/interpretedflow.png"></img>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <h4>1 - Tokenizer</h4>
          <img src="img/lexer1.png" height="150"></img>
          <img src="img/lexer2.png" height="150"></img>
          <img src="img/lexer3.png" height="150"></img>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <h4>2 - Parse</h4>
          <img src="img/ast.png"></img>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <h4>3 - Compila para byte code</h4>
              <pre><code class="lang-ruby">
# code.rb
2 * 7 + 3
              </code></pre>
              <pre><code class="lang-ruby">
puts RubyVM::InstructionSequence.compile(code).disassemble

# == disasm: &lt;RubyVM::InstructionSequence:&lt;compiled&gt;@&lt;compiled&gt;&gt;==========
# 0000 trace            1                                               (   1)
# 0002 putobject        2
# 0004 putobject        7
# 0006 opt_mult         &lt;callinfo!mid:+, argc:1, ARGS_SIMPLE&gt;
# 0008 putobject        3
# 0010 opt_plus         &lt;callinfo!mid:+, argc:1, ARGS_SIMPLE&gt;
# 0012 leave
          </code></pre>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <h4>Finalmente - Interpreta</h4>
          <img src="img/interpreter.png"></img>
        </section>

        <section>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h3>Rust</h3>
          <img class="ferris" src="img/rustaceanhappy.png" width="200"></img>
        </section>

        <section>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h4>Compilada</h4>
          <img src="img/compiler.png"></img>
        </section>

        <section>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h4>Mesmo código em Rust</h4>
          <pre><code class="lang-rust">
fn main() {
  2 * 7 + 3;
}
          </code></pre>
          <pre><code class="lang-bash">
$ rustc code.rs
          </code></pre>
          <pre><code>
// assembly  (Intel)
push    rbp        // bla bla bla stack suff
mov     rbp, rsp
mov     eax, 17    // O QUE IMPORTA: move 17 para o registro de retorno
pop     rbp
ret                // exit
          </code></pre>
          <pre><code class="lang-bash">
$ ./code
          </code></pre>


          <small>http://rust.godbolt.org/</small><br />
          <small>https://godbolt.org/g/wPfcb6</small>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <h4>Ruby - Classes</h4>
          <div style="float: left; width: 30%;">
              <pre><code class="lang-ruby">
class Foo
  def hi
    "Hello"
  end
end

f = Foo.new
f.hi
              </code></pre>
          </div>
          <div>
            <img src="img/rubymethodlookup.png"></img>
          </div>
        </section>

        <section>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h4>Rust - Strucs</h4>
          <div style="float: left; width: 60%;">
              <pre><code class="lang-rust">
struct Foo;

impl Foo {
  pub fn hi(self) -> &str {
      "Hello"
  }
}

fn main() {
  let f = Foo;
  f.hi();
}
              </code></pre>
          </div>
          <div style="font-size: 20px">
            <h4>Compilando</h4>
            <p>Gera cerca de 80 linhas de assembly</p>
            <h4>Com otimização</h4>
            <p>Literalmente um programa vazio</p>
          </div>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <h4>Ruby - Modules - Mixins</h4>
            <pre><code class="lang-ruby">
module Greeting
  def hi
    "bar"
  end
end

class Foo
include Greeting
end

f = Foo.new
puts f.hi
          </code></pre>
        </section>

        <section>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h4>Rust - Traits</h4>
            <pre><code class="lang-rust">
struct Foo;
trait Greeting {
    fn hi(&self) -> &str;
}

impl Greeting for Foo {
    fn hi(&self) -> &str {
        "foo"
    }
}

fn main() {
    let f = Foo;
    println!("{}", f.hi());
}
            </code></pre>
        </section>

        <section>
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
          <h4>Ruby - Ducktype</h4>
          <div style="float: left; width: 50%;">
            <pre><code class="lang-ruby">
class Foo
  def hi
    "foo"
  end
end

class Bar
  def hi
    "bar"
  end
end
          </code></pre>
          </div>
          <div style="float: left; width: 50%;">
          <img class="ruby-logo small-logo" src="img/ruby.png"></img>
            <pre><code class="lang-ruby">
def hello(f)
  puts f.hi
end

foo = Foo.new
hello(foo)

bar = Bar.new
hello(bar)
          </code></pre>
          </div>
        </section>

        <section>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h4>Rust - Generics</h4>
          <div style="float: left; width: 50%;">
            <pre><code class="lang-rust">
struct Bar;
struct Foo;

trait Greeting {
  fn hi(&self) -> &str;
}

impl Greeting for Foo {
  fn hi(&self) -> &str {
      "foo"
  }
}

impl Greeting for Bar {
  fn hi(&self) -> &str {
      "bar"
  }
}

            </code></pre>
          </div>
          <div class="fragment fade-out" style="float: left; width: 50%;">
            <pre><code class="lang-rust">
fn hello&lt;T: Greeting&gt;(f: T) {
  println!("{}", f.hi());
}

fn main() {
  let bar = Bar;
  hello(bar);

  let foo = Foo;
  hello(foo);
}
            </code></pre>
          </div>
          <div class="fragment fade-up" style="float: left; width: 50%;">
          <h5>Monomorphisation</h5>
            <pre><code class="lang-rust">
fn hello&lt;T: Greeting&gt;(f: T) {
  println!("{}", f.hi());
}

fn main() {
  let bar = Bar;
  hello_bar(bar);

  let foo = Foo;
  hello_bar(foo);
}
            </code></pre>
          </div>
        </section>

      <section>
        <h2>Vale a pena aprender Rust</h2>
        <h4>Ele faz você ver as coisas de outro modo.</h4>
      </section>

      <section>
        <h3>Concorrência</h3>
        <img class="ruby-logo small-logo" src="img/ruby.png"></img>
        <pre class="fragment fade-out"><code class="lang-ruby">
words = ["Hello", "world", "from", "Ruby"]

words.map do |w|
  Thread.new do
    puts "#{w}"
  end.join()
end
          </code></pre>
          <pre class="fragment fade-up"><code class="lang-ruby">
words = ["Hello", "world", "from", "Ruby"]

words.map do |w|
  Thread.new do
    words.push(" lol ")
    puts "#{w}"
  end.join()
end
          </code></pre>
          <div class="fragment fade-up">
            <img class="rust-logo small-logo" src="img/rust.png"></img>
            <pre>
            <code class="lang-rust">
use std::thread;

fn main() {
  let words = vec!["Hello", "World", "From", "Rust"];

  for w in words.clone() {
      let _ = thread::spawn(move ||{
          words.push(" lol "); // error: capture of moved value: `words`
          println!("{}", w);
      }).join();
  }
}
          </code></pre></div>
        </section>

        <section>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h2>O segredo do Rust é seu sistema</h2>
          <h4>Ownership e Borrowing</h4>
        </section>

        <section>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h4>Ownership</h4>
          <pre><code class="lang-rust">
fn take(list: Vec&lt;i32&gt;) { println!("take {:?}", list); }

fn main() {
  let a = vec![10, 5, 4];
  let b = a; // Transfere o owner
  let c = b; // Transfere o owner

  take(c); // único valido
  println!("{:?}", a); // ERRROUUU (Fausto Silva Voice)
}
          </code></pre>
        </section>

        <section>
          <img class="rust-logo small-logo" src="img/rust.png"></img>
          <h4>Borrowing</h4>
            <pre><code class="lang-rust">
fn take(list: &Vec&lt;i32&gt;) { println!("take {:?}", list); }

fn main() {
  let a = vec![10, 5, 4]; // a (owner) entra no scopo
  take(&a); // Empresta Ok
  let b = &a; // Empresta
  let c = &b; // Empresta

  println!("{:?}", a); // Ok
  println!("{:?}", c); // Ok
} // todas saem do scopo
          </code></pre>
        </section>

        <!-- ExplanationPartEnd -->
        </section>

        <section>
          <section>
            <img src="img/flexperf.jpg" >
          </section>
          <section>
            <img id="dealwithit" onclick="deal" src="img/ruby_rust.jpg"></img>
          </section>
          <section>
            <h1>Muito Obrigado</h1>
          </section>
        </section>
      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>
    <script src="js/playpen.js"></script>

    <script>

// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
  controls: true,
  progress: true,
  history: true,
  center: true,
  viewDistance: 1,

  theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
  transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

    // Optional libraries used to extend on reveal.js
  dependencies: [
    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
  ]
});

function deal() {
  document.getElementById('dealwithit').src = "img/dealwithit.gif";
}

document.getElementById('dealwithit').addEventListener('click', deal);
    </script>
  </body>
</html>
